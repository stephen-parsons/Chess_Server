<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Chess Server</title>
	<base href="/">

	<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- 	<link rel="icon" type="image/x-icon" href="favicon.ico"> -->

	<!-- BOOTSTRAP -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
	<script type="text/javascript" src="http://underscorejs.org/underscore-min.js"></script>

	<!-- JQUERY -->
	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

  	<!-- SOCKETS -->
  	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.16/angular.min.js"></script>
    <script src="/assets/socket.io.js"></script>
    <script src="/assets/angular-sockets.js"></script>

    <script src="/assets/circular-json.js"></script>

    <script type="text/javascript" src="/assets/chessInterface/interface.js"></script>

    <script type="application/javascript">

		var CircularJSON = window.CircularJSON;

    	var playerColor;

    	var socketId;

    	var app = angular.module('socketApp', [ 'socket.io' ]);
	    
	    app.config(function ($socketProvider) {
	    	// console.log(('http://localhost:8000/game/'+gameId))
	        $socketProvider.setConnectionUrl('http://192.168.1.13:8000/');
	    });
	    
	    app.controller('Ctrl', function Ctrl($scope, $socket) {
	    	console.log(window.location.href)

	        $socket.on('playerConnected', function (data) {
	        	console.log("Player "+data+" connected!");
	        	//assign player
	        	// playerColor = data;
	        	socketId = data;
	        	$scope.socketId = data;
	        });

	        $socket.on('recieveMove', function(dataBack){	
            	// console.log("Move Data :", dataBack)
            	updateGame(CircularJSON.parse(dataBack));
            	console.log("Updated board game!");
            	postGameData(dataBack, (game)=>{
					// console.log("POST GAME DATA :", CircularJSON.parse(game.moveList));
					setListeners();
				});
            });	

	        $scope.sendMove = function sendMove(data) {
	            // console.log('sending move: ', data);
	            $socket.emit('sendMove', data, function(cb){
	            	console.log(cb);
	            });
	        };
	    });
    	
	</script>

</head>
<body>
  <app-root ng-app="socketApp" ng-controller="Ctrl"></app-root>
<script type="text/javascript" src="inline.bundle.js"></script><script type="text/javascript" src="polyfills.bundle.js"></script><script type="text/javascript" src="styles.bundle.js"></script><script type="text/javascript" src="vendor.bundle.js"></script><script type="text/javascript" src="main.bundle.js"></script></body>
</html>
